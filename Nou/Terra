#include <SoftwareSerial.h>
#define aAmarilla 2
#define aRoja 6
#define aVerde 4
SoftwareSerial mySerial(10, 11); // RX, TX 

float temperatura = 0;
float humedad = 0;
float dist = 0;

float posicionX = 0;
float posicionY = 0;
float posicionZ = 0;


bool aDHT = 0;      // Variables de alarmas
bool aCerca = 0; 
bool aTiempo = 0;

int nextFalloTiempo; //Esperar para las alarmas
int intervalFalloTiempo = 5000;



void setup() {
  Serial.begin(9600);
  mySerial.begin(9600);
  pinMode(aAmarilla, OUTPUT);
  pinMode(aRoja, OUTPUT);
  pinMode(aVerde, OUTPUT);
}


  //--------------------------------------------------
  // LECTURA SERIAL DEL MÓDULO
  //--------------------------------------------------
  void loop() {

  if (mySerial.available()) {

    String input = mySerial.readStringUntil('\n');
    input.trim();
    Serial.println(input);
}


  //--------------------------------------------------
  // TIMEOUT
  //--------------------------------------------------
  if (millis() > nextFalloTiempo) { //avisa si hay un fallo en un periodo de tiempo
    aTiempo = 1;
  }

  //--------------------------------------------------
  // LEDS
  //--------------------------------------------------
  digitalWrite(aAmarilla, aTiempo == 0 ? HIGH : LOW);
  digitalWrite(aRoja,     aDHT == 0    ? HIGH : LOW);
  digitalWrite(aVerde,    aCerca == 0  ? HIGH : LOW);


  //--------------------------------------------------
  // ENVÍO DE DATOS A PYTHON
  //--------------------------------------------------
  if (Serial.available()) {
    String Comandos = Serial.readStringUntil('\n');  // leer de Python
    Comandos.trim();
    
    mySerial.println(Comandos); // enviar al otro Arduino
  }
}

